
========
Shaker Components
========

Shaker is comprised of three components that work together in various ways depending on the environment.

Shaker Core
###############
.. image:: images/shaker_core.png
   :scale: 80%
Shaker Core is the foundation of Shaker. It alone has the ability to parse shaker.json configuration files, compute and resolve rollup dimensions and dependencies, and ultimately generate rollup metadata.

Shaker Compiler
##########

.. image:: images/shaker_compiler.png
   :scale: 80%

The Shaker compiler is the build time component of Shaker. It employs Shaker Core to generate the metadata, and uses it to create the rollups for the application.

Shaker compiler can be configured per enviroment(staging, test, production) throught application.json and also you can decide what actions to apply to the rollups (minify,csslint...). Moreover you can set what we call "deployment tasks" which allow developpers to deploy the assets to different places:

- ``raw`` - Deploy the assets without doing rollups. This mode will pick the files directly from local (handy for development).

- ``local`` - Deploy the assets in rollups and save the files in local.

- ``mobstor`` - Deploy the assets in rollups and upload them to Mobstor (Yahoo! CDN).

- ``S3`` - Deploy the assets as rollups and upload them to Amazon S3 CDN.


Shaker Addon and ShakerHTMLFrame
##########

.. image:: images/shaker_addon.png
   :scale: 80%

The Shaker Mojito addon is the run time component of Shaker. It reads the metadata generated by the Screwdriver compiler, and subsequently manages assets within the application, picking the correct rollup based on the current environment. 

The ShakerHTMLFrame is just a copy of Mojito HTMLFrame but including the addon and executing Shaker in a specific point in time.
If you have your own HTMLFrame you just have to include the addon dependency and execute it before the assets get pushed throw the view.


All the pieces together
##########